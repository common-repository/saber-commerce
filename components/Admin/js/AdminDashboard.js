var AdminDashboard = {

	rootElement: jQuery( 'sacom-dashboard' ),

	init: function() {

		var h = '';

		// Dashboard wrapper element.
		h += '<div id="sacom-dashboard">';

		// Dashboard header grid element.
		h += '<div id="sacom-dashboard-header">';

		// Logo.
		h += '<div id="sacom-header-logo">';
		h += '<svg width="256" height="97" viewBox="0 0 256 97" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M88.476 68.434C85.624 68.434 83.0613 67.938 80.788 66.946C78.556 65.9127 76.7993 64.5073 75.518 62.73C74.2367 60.9113 73.5753 58.824 73.534 56.468H79.548C79.7547 58.4933 80.5813 60.2087 82.028 61.614C83.516 62.978 85.6653 63.66 88.476 63.66C91.1627 63.66 93.2707 62.9987 94.8 61.676C96.3707 60.312 97.156 58.576 97.156 56.468C97.156 54.8147 96.7013 53.4713 95.792 52.438C94.8827 51.4047 93.746 50.6193 92.382 50.082C91.018 49.5447 89.1787 48.966 86.864 48.346C84.012 47.602 81.718 46.858 79.982 46.114C78.2873 45.37 76.82 44.2127 75.58 42.642C74.3813 41.03 73.782 38.8807 73.782 36.194C73.782 33.838 74.3813 31.7507 75.58 29.932C76.7787 28.1133 78.4527 26.708 80.602 25.716C82.7927 24.724 85.2933 24.228 88.104 24.228C92.1547 24.228 95.4613 25.2407 98.024 27.266C100.628 29.2913 102.095 31.978 102.426 35.326H96.226C96.0193 33.6727 95.1513 32.226 93.622 30.986C92.0927 29.7047 90.0673 29.064 87.546 29.064C85.19 29.064 83.268 29.684 81.78 30.924C80.292 32.1227 79.548 33.8173 79.548 36.008C79.548 37.5787 79.982 38.86 80.85 39.852C81.7593 40.844 82.8547 41.6087 84.136 42.146C85.4587 42.642 87.298 43.2207 89.654 43.882C92.506 44.6673 94.8 45.4527 96.536 46.238C98.272 46.982 99.76 48.16 101 49.772C102.24 51.3427 102.86 53.492 102.86 56.22C102.86 58.328 102.302 60.312 101.186 62.172C100.07 64.032 98.4167 65.5407 96.226 66.698C94.0353 67.8553 91.452 68.434 88.476 68.434ZM136.707 58.39H117.859L114.387 68H108.435L124.059 25.034H130.569L146.131 68H140.179L136.707 58.39ZM135.095 53.802L127.283 31.978L119.471 53.802H135.095ZM174.578 45.742C176.149 45.99 177.575 46.6307 178.856 47.664C180.179 48.6973 181.212 49.9787 181.956 51.508C182.741 53.0373 183.134 54.67 183.134 56.406C183.134 58.5967 182.576 60.5807 181.46 62.358C180.344 64.094 178.711 65.4787 176.562 66.512C174.454 67.504 171.953 68 169.06 68H152.94V24.786H168.44C171.375 24.786 173.875 25.282 175.942 26.274C178.009 27.2247 179.559 28.5267 180.592 30.18C181.625 31.8333 182.142 33.6933 182.142 35.76C182.142 38.3227 181.439 40.4513 180.034 42.146C178.67 43.7993 176.851 44.998 174.578 45.742ZM158.582 43.448H168.068C170.713 43.448 172.759 42.828 174.206 41.588C175.653 40.348 176.376 38.6327 176.376 36.442C176.376 34.2513 175.653 32.536 174.206 31.296C172.759 30.056 170.672 29.436 167.944 29.436H158.582V43.448ZM168.564 63.35C171.375 63.35 173.565 62.6887 175.136 61.366C176.707 60.0433 177.492 58.204 177.492 55.848C177.492 53.4507 176.665 51.57 175.012 50.206C173.359 48.8007 171.147 48.098 168.378 48.098H158.582V63.35H168.564ZM196.605 29.374V43.82H212.353V48.47H196.605V63.35H214.213V68H190.963V24.724H214.213V29.374H196.605ZM245.505 68L235.213 50.33H228.393V68H222.751V24.786H236.701C239.966 24.786 242.715 25.344 244.947 26.46C247.22 27.576 248.915 29.0847 250.031 30.986C251.147 32.8873 251.705 35.0573 251.705 37.496C251.705 40.472 250.837 43.0967 249.101 45.37C247.406 47.6433 244.843 49.152 241.413 49.896L252.263 68H245.505ZM228.393 45.804H236.701C239.759 45.804 242.053 45.06 243.583 43.572C245.112 42.0427 245.877 40.0173 245.877 37.496C245.877 34.9333 245.112 32.9493 243.583 31.544C242.095 30.1387 239.801 29.436 236.701 29.436H228.393V45.804Z" fill="#716C53"/><path d="M115.946 80.322C115.946 78.826 116.283 77.484 116.958 76.296C117.633 75.0933 118.549 74.1547 119.708 73.48C120.881 72.8053 122.179 72.468 123.602 72.468C125.274 72.468 126.733 72.8713 127.98 73.678C129.227 74.4847 130.136 75.6287 130.708 77.11H128.31C127.885 76.186 127.269 75.4747 126.462 74.976C125.67 74.4773 124.717 74.228 123.602 74.228C122.531 74.228 121.571 74.4773 120.72 74.976C119.869 75.4747 119.202 76.186 118.718 77.11C118.234 78.0193 117.992 79.09 117.992 80.322C117.992 81.5393 118.234 82.61 118.718 83.534C119.202 84.4433 119.869 85.1473 120.72 85.646C121.571 86.1447 122.531 86.394 123.602 86.394C124.717 86.394 125.67 86.152 126.462 85.668C127.269 85.1693 127.885 84.458 128.31 83.534H130.708C130.136 85.0007 129.227 86.1373 127.98 86.944C126.733 87.736 125.274 88.132 123.602 88.132C122.179 88.132 120.881 87.802 119.708 87.142C118.549 86.4673 117.633 85.536 116.958 84.348C116.283 83.16 115.946 81.818 115.946 80.322ZM142.84 88.154C141.417 88.154 140.119 87.824 138.946 87.164C137.773 86.4893 136.841 85.558 136.152 84.37C135.477 83.1673 135.14 81.818 135.14 80.322C135.14 78.826 135.477 77.484 136.152 76.296C136.841 75.0933 137.773 74.162 138.946 73.502C140.119 72.8273 141.417 72.49 142.84 72.49C144.277 72.49 145.583 72.8273 146.756 73.502C147.929 74.162 148.853 75.086 149.528 76.274C150.203 77.462 150.54 78.8113 150.54 80.322C150.54 81.8327 150.203 83.182 149.528 84.37C148.853 85.558 147.929 86.4893 146.756 87.164C145.583 87.824 144.277 88.154 142.84 88.154ZM142.84 86.416C143.911 86.416 144.871 86.1667 145.722 85.668C146.587 85.1693 147.262 84.458 147.746 83.534C148.245 82.61 148.494 81.5393 148.494 80.322C148.494 79.09 148.245 78.0193 147.746 77.11C147.262 76.186 146.595 75.4747 145.744 74.976C144.893 74.4773 143.925 74.228 142.84 74.228C141.755 74.228 140.787 74.4773 139.936 74.976C139.085 75.4747 138.411 76.186 137.912 77.11C137.428 78.0193 137.186 79.09 137.186 80.322C137.186 81.5393 137.428 82.61 137.912 83.534C138.411 84.458 139.085 85.1693 139.936 85.668C140.801 86.1667 141.769 86.416 142.84 86.416ZM170.937 72.776V88H168.935V76.648L163.875 88H162.467L157.385 76.626V88H155.383V72.776H157.539L163.171 85.36L168.803 72.776H170.937ZM192.086 72.776V88H190.084V76.648L185.024 88H183.616L178.534 76.626V88H176.532V72.776H178.688L184.32 85.36L189.952 72.776H192.086ZM199.684 74.294V79.42H205.272V81.07H199.684V86.35H205.932V88H197.682V72.644H205.932V74.294H199.684ZM219.235 88L215.583 81.73H213.163V88H211.161V72.666H216.111C217.269 72.666 218.245 72.864 219.037 73.26C219.843 73.656 220.445 74.1913 220.841 74.866C221.237 75.5407 221.435 76.3107 221.435 77.176C221.435 78.232 221.127 79.1633 220.511 79.97C219.909 80.7767 219 81.312 217.783 81.576L221.633 88H219.235ZM213.163 80.124H216.111C217.196 80.124 218.01 79.86 218.553 79.332C219.095 78.7893 219.367 78.0707 219.367 77.176C219.367 76.2667 219.095 75.5627 218.553 75.064C218.025 74.5653 217.211 74.316 216.111 74.316H213.163V80.124ZM225.998 80.322C225.998 78.826 226.335 77.484 227.01 76.296C227.684 75.0933 228.601 74.1547 229.76 73.48C230.933 72.8053 232.231 72.468 233.654 72.468C235.326 72.468 236.785 72.8713 238.032 73.678C239.278 74.4847 240.188 75.6287 240.76 77.11H238.362C237.936 76.186 237.32 75.4747 236.514 74.976C235.722 74.4773 234.768 74.228 233.654 74.228C232.583 74.228 231.622 74.4773 230.772 74.976C229.921 75.4747 229.254 76.186 228.77 77.11C228.286 78.0193 228.044 79.09 228.044 80.322C228.044 81.5393 228.286 82.61 228.77 83.534C229.254 84.4433 229.921 85.1473 230.772 85.646C231.622 86.1447 232.583 86.394 233.654 86.394C234.768 86.394 235.722 86.152 236.514 85.668C237.32 85.1693 237.936 84.458 238.362 83.534H240.76C240.188 85.0007 239.278 86.1373 238.032 86.944C236.785 87.736 235.326 88.132 233.654 88.132C232.231 88.132 230.933 87.802 229.76 87.142C228.601 86.4673 227.684 85.536 227.01 84.348C226.335 83.16 225.998 81.818 225.998 80.322ZM247.942 74.294V79.42H253.53V81.07H247.942V86.35H254.19V88H245.94V72.644H254.19V74.294H247.942Z" fill="#BDBDBD"/><path d="M54.4375 43.7083C47.5002 43.7083 41.875 49.3335 41.875 56.2708C41.875 63.2081 47.5002 68.8333 54.4375 68.8333C61.3748 68.8333 67 63.2081 67 56.2708C67 49.3335 61.3748 43.7083 54.4375 43.7083ZM53.1282 61.8095L48.4159 57.2395L50.3589 55.2937L53.1254 57.9179L59.0326 51.8628L60.9756 53.8058L53.1282 61.8095ZM11.1667 54.875H25.125V57.6667H11.1667V54.875ZM33.5 52.0833H11.1667V49.2917H33.5V52.0833ZM37.6931 63.25H6.97917C6.20867 63.25 5.58333 62.6247 5.58333 61.8542V43.7083H41.3725C44.6778 40.2746 49.3064 38.125 54.4375 38.125C56.9109 38.125 59.2643 38.6247 61.4167 39.5236V29.75C61.4167 26.668 58.9153 24.1667 55.8333 24.1667H5.58333C2.50133 24.1667 0 26.668 0 29.75V63.25C0 66.332 2.50133 68.8333 5.58333 68.8333H41.3725C39.8287 67.2253 38.5641 65.341 37.6931 63.25ZM5.58333 31.1458C5.58333 30.3753 6.20867 29.75 6.97917 29.75H54.4375C55.208 29.75 55.8333 30.3753 55.8333 31.1458V35.3333H5.58333V31.1458Z" fill="#2271B1"/></svg>';
		h += '</div>';

		// Dashboard title.
		h += '<div class="sacom-dashboard-title">';
		h += '<h5>';
		h += dashboardData.strings.version;
		h += ' ';
		h += dashboardData.saberCommerceVersion;
		h += '</h5>';
		h += '<h2>';
		h += dashboardData.strings.dashboard_uppercase;
		h += '</h2>';

		h += '</div>';

		// Dashboard title.
		h += '<div id="sacom-dashboard-help" class="sacom-dashboard-help">';
		h += '<button class="sacom-page-header-button sacom-button">';
		h += '<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="life-ring" class="svg-inline--fa fa-life-ring fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 504c136.967 0 248-111.033 248-248S392.967 8 256 8 8 119.033 8 256s111.033 248 248 248zm-103.398-76.72l53.411-53.411c31.806 13.506 68.128 13.522 99.974 0l53.411 53.411c-63.217 38.319-143.579 38.319-206.796 0zM336 256c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zm91.28 103.398l-53.411-53.411c13.505-31.806 13.522-68.128 0-99.974l53.411-53.411c38.319 63.217 38.319 143.579 0 206.796zM359.397 84.72l-53.411 53.411c-31.806-13.505-68.128-13.522-99.973 0L152.602 84.72c63.217-38.319 143.579-38.319 206.795 0zM84.72 152.602l53.411 53.411c-13.506 31.806-13.522 68.128 0 99.974L84.72 359.398c-38.319-63.217-38.319-143.579 0-206.796z"></path></svg>';
		h += dashboardData.strings.need_help;
		h += '</button>';
		h += '</div>';

		// Close header.
		h += '</div>';

		// Open grid.
		h += '<div class="sacom-dashboard-grid">';

		h += '<div id="react-app"></div><!-- #react-app -->';

		console.log( dashboardData.widgets )

		dashboardData.widgets.forEach( function( widget, index ) {

			h += AdminDashboard.renderWidget( widget, index );

		});

		// Close grid.
		h += '</div>';

		// Dashboard footer grid.
		h += '<div id="dashboard-footer">';

		h += '<div id="dashboard-footer-row-1">';

		// Footer > Manage settings.
		h += '<div class="dashboard-footer-settings">';
		h += '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sliders-h" class="svg-inline--fa fa-sliders-h fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M496 384H160v-16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h80v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h336c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm0-160h-80v-16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h336v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h80c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm0-160H288V48c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16C7.2 64 0 71.2 0 80v32c0 8.8 7.2 16 16 16h208v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h208c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16z"></path></svg>';
		h += '<span>';
		h += dashboardData.strings.manage_settings;
		h += '</span>';
		h += '</div>';

		// Footer > Donate.
		h += '<div class="dashboard-footer-donate sacom-dashboard-donate">';
		h += '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="wallet" class="svg-inline--fa fa-wallet fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M461.2 128H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h384c8.84 0 16-7.16 16-16 0-26.51-21.49-48-48-48H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h397.2c28.02 0 50.8-21.53 50.8-48V176c0-26.47-22.78-48-50.8-48zM416 336c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path></svg>';
		h += '<span>';
		h += dashboardData.strings.donate_to_support;
		h += '</span>';
		h += '</div>';

		// End row 1.
		h += '</div>';

		// Footer > Support.
		h += '<div class="dashboard-footer-support sacom-dashboard-help">';
		h += '<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="life-ring" class="svg-inline--fa fa-life-ring fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 504c136.967 0 248-111.033 248-248S392.967 8 256 8 8 119.033 8 256s111.033 248 248 248zm-103.398-76.72l53.411-53.411c31.806 13.506 68.128 13.522 99.974 0l53.411 53.411c-63.217 38.319-143.579 38.319-206.796 0zM336 256c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zm91.28 103.398l-53.411-53.411c13.505-31.806 13.522-68.128 0-99.974l53.411-53.411c38.319 63.217 38.319 143.579 0 206.796zM359.397 84.72l-53.411 53.411c-31.806-13.505-68.128-13.522-99.973 0L152.602 84.72c63.217-38.319 143.579-38.319 206.795 0zM84.72 152.602l53.411 53.411c-13.506 31.806-13.522 68.128 0 99.974L84.72 359.398c-38.319-63.217-38.319-143.579 0-206.796z"></path></svg>';
		h += '<span>';
		h += dashboardData.strings.open_support_ticket;
		h += '</span>';
		h += '</div>';

		// Footer > Review.
		let star = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"></path></svg>';
		h += '<div class="dashboard-footer-review">';
		h += '<span>';
		h += dashboardData.strings.share_your_review;
		h += '</span>';
		h += '<div class="dashboard-footer-review-stars">';
		h += star + star + star + star + star;
		h += '</div>';
		h += '</div>';

		// Close dashboard footer.
		h += '</div>';

		// Close dashboard wrapper element.
		h += '</div>';

		AdminDashboard.rootElement.html( h );

		AdminDashboard.settingsButtonClickEvent();

		jQuery( document ).on( 'click', '#sacom-header-logo', function() {

			window.location = dashboardData.adminUrl + '/admin.php?page=sacom';

		});

	},

	standardizeLatestItems: function( items, adminItemPath, idField, titleField ) {

		var newList = [];

		jQuery.each( items, function( index, item ) {

			var item = {

				path: dashboardData.adminUrl + 'admin.php?page=sacom-' + adminItemPath + '#/view/' + item[ idField ],
				title: item[ titleField ]

			};

			newList.push( item );

		});

		return newList;

	},

	makeItemHeader: function( svg, title ) {

		var h = '';
		h += '<div class="sacom-dashboard-grid-item-header">';
		h += svg;
		h += '<h2>';
		h += title;
		h += '</h2>';
		h += '</div>';
		return h;

	},

	makeLatestList: function( label, items ) {

		var h = '';
		h += '<div class="dashboard-latest-list">';

		h += '<h2>';
		h += label;
		h += '</h2>';

		h += '<ul>';

		jQuery.each( items, function( index, item ) {

			h += '<li data-path="' + item.path + '">';

			if( item.title ) {
				h += item.title;
			}

			h += '</li>';

		});

		h += '</ul>';

		h += '</div>';
		return h;

	},

	makeButtonLink: function( label, page ) {

		var h = '';
		h += '<div class="sacom-dashboard-button">';
		h += '<a href="' + dashboardData.adminUrl + 'admin.php' + page + '"';
		h += '<button>';
		h += label;
		h += '</button>';
		h += '</a>';
		h += '</div>';
		return h;



	},

	makeStat: function( label, data ) {

		var h = '';
		h += '<div class="sacom-dashboard-stat">';
		h += '<h2>';
		h += data;
		h += '</h2>';
		h += '<h4>';
		h += label;
		h += '</h4>';
		h += '</div>';
		return h;

	},

	settingsButtonClickEvent: function() {

		jQuery( document ).on( 'click', '.dashboard-footer-settings', function() {

			let settingsUrl = AdminDashboard.getSettingsUrl();
			window.location = settingsUrl;

		});

	},

	getSettingsUrl: function() {

		return dashboardData.adminUrl + 'admin.php?page=sacom-settings';

	},

	renderWidget( widget, index ) {

		console.log('renderWidget...' + widget)

		var h = '';

		// Accounts.
		h += '<div class="sacom-dashboard-grid-item">';

		// Header.
		var svg = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-shield" class="svg-inline--fa fa-user-shield fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"></path></svg>';
		h += AdminDashboard.makeItemHeader( widget.headingIcon, widget.headingText );

		// Body.
		var itemList = AdminDashboard.standardizeLatestItems( widget.latestList, widget.adminItemPath, widget.idField, widget.titleField );
		h += '<div class="sacom-dashboard-grid-item-body">';
		h += AdminDashboard.makeStat( widget.statLabel, widget.statNumber );
		h += AdminDashboard.makeLatestList( widget.latestHeading, itemList );
		h += '</div>';

		h += '<div class="sacom-dashboard-grid-item-footer">';
		h += AdminDashboard.makeButtonLink( widget.buttonLabel, widget.buttonUrl );
		h += '</div>';

		h += '</div>';

		return h;

	}


}

AdminDashboard.init();
